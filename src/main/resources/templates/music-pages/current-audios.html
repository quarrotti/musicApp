<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ú—É–∑—ã–∫–∞ - Music App</title>
  <style>
    body {
      background-color: black;
      color: #00BFFF; /* –ì–æ–ª—É–±–æ–π —Ü–≤–µ—Ç */
      font-family: 'Helvetica Neue', 'Arial', sans-serif;
      margin: 0;
      display: flex;
      height: 100vh;
    }
    .sidebar {
      width: 250px;
      background-color: #1c1c1c;
      padding: 20px;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
    }
    .sidebar h2 {
      margin: 0;
      margin-bottom: 15px;
      cursor: pointer;
    }
    .music-center {
      flex-grow: 1;
      padding: 20px;
      background-color: #2c2c2c;
      color: white;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
    }
    .music-list {
      list-style: none;
      padding: 0;
      margin-top: 10px; /* –û—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É –¥–ª—è —Å–ø–∏—Å–∫–∞ */
    }
    .music-list li {
      margin-bottom: 10px;
      cursor: pointer; /* –£–∫–∞–∑–∞—Ç–µ–ª—å –∫—É—Ä—Å–æ—Ä–∞ –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç—ã —Å–ø–∏—Å–∫–∞ */
      display: flex; /* –ò—Å–ø–æ–ª—å–∑—É–µ–º flex –¥–ª—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è */
      justify-content: space-between; /* –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –º–µ–∂–¥—É —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ */
      align-items: center; /* –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ */
    }
  </style>
</head>
<body>

<div class="sidebar">
  <h2 onclick="location.href='/general'">–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞</h2>
  <h2 onclick="location.href='/music'">–í—Å—è –º—É–∑—ã–∫–∞</h2>
  <h2 onclick="location.href='/personal-music'">–í–∞—à–∞ –º—É–∑—ã–∫–∞</h2>
</div>

<div class="music-center">

  <h2 style="display: flex; align-items: center; margin-bottom: 5px;">
     –ú—É–∑—ã–∫–∞ –ø–æ –≤–∞—à–µ–º—É –∑–∞–ø—Ä–æ—Å—É
    <div class="controls" id="audioControls" style="display: none;">
      <span class="play-pause" id="playPauseButton">‚ñ∂</span>
      <span class="restart" id="restartButton">üîÑ</span>
    </div>
  </h2>
  <ul class="music-list">
    <li th:each="audio : ${currentAudios}">
            <span th:text="${audio.name}"
                  th:onclick="'playTrack(\'/audio/stream/' + ${audio.id} + '\')'"
                  style="cursor: pointer;"></span>
      <span> by <span th:if="${audio.creator.email == currentUser  .email}">your</span>
                  <span th:if="${audio.creator.email != currentUser  .email}" th:text="${audio.creator.username}"></span></span>
      <form th:action="@{/add-music/{id}(id=${audio.id})}" method="post" style="display: inline;">
        <button type="submit" class="add-button">–î–æ–±–∞–≤–∏—Ç—å –∫ —Å–µ–±–µ</button>
      </form>
    </li>
  </ul>
  <div th:if="${#lists.isEmpty(currentAudios)}">
    <p>–ü–æ –≤–∞—à–µ–º—É –∑–∞–ø—Ä–æ—Å—É –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p>
    <button class="upload-button" onclick="location.href='/load-audio'">–î–æ–±–∞–≤–∏—Ç—å –º—É–∑—ã–∫—É</button>
  </div>
  <audio id="audioPlayer" controls style="display: none;"></audio>
</div>


<script>
  const audioPlayer = document.getElementById('audioPlayer');
  const playPauseButton = document.getElementById('playPauseButton');
  const restartButton = document.getElementById('restartButton');
  const audioControls = document.getElementById('audioControls');
  function playTrack(audioUrl) {
    audioPlayer.src = audioUrl; // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∞—É–¥–∏–æ
    audioControls.style.display = 'flex'; // –ü–æ–∫–∞–∑–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
    audioPlayer.play(); // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º —Ç—Ä–µ–∫
    playPauseButton.textContent = '‚ùö‚ùö'; // –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞ –ø–∞—É–∑—É
  }

  playPauseButton.addEventListener('click', () => {
    if (audioPlayer.paused) {
      audioPlayer.play();
      playPauseButton.textContent = '‚ùö‚ùö'; // –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞ –ø–∞—É–∑—É
    } else {
      audioPlayer.pause();
      playPauseButton.textContent = '‚ñ∂'; // –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
    }
  });

  restartButton.addEventListener('click', () => {
    audioPlayer.currentTime = 0; // –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç—Ä–µ–∫
    audioPlayer.play(); // –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
    playPauseButton.textContent = '‚ùö‚ùö'; // –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞ –ø–∞—É–∑—É
  });
</script>

</body>
</html>
