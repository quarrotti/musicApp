<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú—É–∑—ã–∫–∞ - Music App</title>
    <style>
        body {
            background-color: black;
            color: #00BFFF; /* –ì–æ–ª—É–±–æ–π —Ü–≤–µ—Ç */
            font-family: 'Helvetica Neue', 'Arial', sans-serif;
            margin: 0;
            display: flex;
            height: 100vh;
        }
        .sidebar {
            width: 250px;
            background-color: #1c1c1c;
            padding: 20px;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
        }
        .sidebar h2 {
            margin: 0;
            margin-bottom: 15px;
            cursor: pointer;
        }
        .music-center {
            flex-grow: 1;
            padding: 20px;
            background-color: #2c2c2c;
            color: white;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
        }
        .music-list {
            list-style: none;
            padding: 0;
            margin-top: 10px; /* –û—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É –¥–ª—è —Å–ø–∏—Å–∫–∞ */
        }
        .music-list li {
            margin-bottom: 10px;
            cursor: pointer; /* –£–∫–∞–∑–∞—Ç–µ–ª—å –∫—É—Ä—Å–æ—Ä–∞ –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç—ã —Å–ø–∏—Å–∫–∞ */
            display: flex; /* –ò—Å–ø–æ–ª—å–∑—É–µ–º flex –¥–ª—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è */
            justify-content: space-between; /* –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –º–µ–∂–¥—É —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ */
            align-items: center; /* –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ */
        }
        .search-button {
            background-color: red; /* –ö—Ä–∞—Å–Ω—ã–π —Ü–≤–µ—Ç */
            color: white;
            border: none;
            border-radius: 5px; /* –°–∫—Ä—É–≥–ª–µ–Ω–∏–µ —É–≥–ª–æ–≤ */
            padding: 15px; /* –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤—ã—Å–æ—Ç—ã –∫–Ω–æ–ø–∫–∏ */
            cursor: pointer;
            font-size: 16px; /* –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —à—Ä–∏—Ñ—Ç–∞ */
            width: 100%; /* –®–∏—Ä–∏–Ω–∞ –∫–Ω–æ–ø–∫–∏ –Ω–∞ –≤—Å—é —à–∏—Ä–∏–Ω—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ */
            box-sizing: border-box; /* –£—á–∏—Ç—ã–≤–∞—Ç—å padding –≤ —à–∏—Ä–∏–Ω–µ */
            margin-bottom: 10px; /* –û—Ç—Å—Ç—É–ø —Å–Ω–∏–∑—É –¥–ª—è –∫–Ω–æ–ø–∫–∏ */
        }
        .search-button:hover {
            background-color: darkred; /* –¶–≤–µ—Ç –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
        }
        .search-form {
            margin-bottom: 10px; /* –û—Ç—Å—Ç—É–ø —Å–Ω–∏–∑—É –¥–ª—è —Ñ–æ—Ä–º—ã –ø–æ–∏—Å–∫–∞ */
            display: flex; /* Flex –¥–ª—è —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ —Å—Ç—Ä–æ–∫—É */
            flex-direction: column; /* –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ */
        }
        .search-input, .genre-select {
            padding: 10px;
            border: 1px solid #00BFFF;
            border-radius: 5px; /* –°–∫—Ä—É–≥–ª–µ–Ω–∏–µ —É–≥–ª–æ–≤ */
            background-color: #1c1c1c;
            color: white;
            margin-bottom: 10px; /* –û—Ç—Å—Ç—É–ø —Å–Ω–∏–∑—É –¥–ª—è –∏–Ω–ø—É—Ç–æ–≤ */
        }
        .search-input::placeholder {
            color: #00BFFF; /* –¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ –≤ placeholder */
        }
        .search-submit {
            padding: 10px; /* –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ padding */
            border: 1px solid #00BFFF;
            background-color: #00BFFF;
            color: white;
            cursor: pointer;
        }
        .search-submit:hover {
            background-color: #008CBA; /* –¶–≤–µ—Ç –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
        }
        #audioControls {
            display: flex; /* –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –Ω–∞ flex –¥–ª—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è */
            margin-left: 0; /* –£–±—Ä–∞–ª–∏ –æ—Ç—Å—Ç—É–ø –º–µ–∂–¥—É –∑–∞–≥–æ–ª–æ–≤–∫–æ–º –∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
            align-items: center; /* –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ */
        }
        .controls span {
            margin-left: 5px; /* –£–º–µ–Ω—å—à–µ–Ω–Ω—ã–π –æ—Ç—Å—Ç—É–ø –º–µ–∂–¥—É –∫–Ω–æ–ø–∫–∞–º–∏ */
            cursor: pointer;
        }
        .upload-button {
            background-color: #00BFFF; /* –°–∏–Ω–∏–π —Ü–≤–µ—Ç */
            color: white;
            border: none;
            border-radius: 5px; /* –°–∫—Ä—É–≥–ª–µ–Ω–∏–µ —É–≥–ª–æ–≤ */
            padding: 15px; /* –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤—ã—Å–æ—Ç—ã –∫–Ω–æ–ø–∫–∏ */
            cursor: pointer;
            font-size: 16px; /* –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —à—Ä–∏—Ñ—Ç–∞ */
            width: 100%; /* –®–∏—Ä–∏–Ω–∞ –∫–Ω–æ–ø–∫–∏ –Ω–∞ –≤—Å—é —à–∏—Ä–∏–Ω—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ */
            box-sizing: border-box; /* –£—á–∏—Ç—ã–≤–∞—Ç—å padding –≤ —à–∏—Ä–∏–Ω–µ */
        }
        .upload-button:hover {
            background-color: #008CBA; /* –¶–≤–µ—Ç –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
        }
        .add-button {
            background-color: #00BFFF; /* –°–∏–Ω–∏–π —Ü–≤–µ—Ç */
            color: white;
            border: none;
            border-radius: 5px; /* –°–∫—Ä—É–≥–ª–µ–Ω–∏–µ —É–≥–ª–æ–≤ */
            padding: 5px 10px; /* –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤—ã—Å–æ—Ç—ã –∫–Ω–æ–ø–∫–∏ */
            cursor: pointer;
            font-size: 14px; /* –†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ */
        }
        .add-button:hover {
            background-color: #008CBA; /* –¶–≤–µ—Ç –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
        }
    </style>
</head>
<body>

<div class="sidebar">
    <h2 onclick="location.href='/general'">–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞</h2>
    <h2 onclick="location.href='/personal-music'">–í–∞—à–∞ –º—É–∑—ã–∫–∞</h2>

    <!-- –§–æ—Ä–º–∞ –ø–æ–∏—Å–∫–∞ -->
    <form class="search-form" method="get" action="/search-audio">
        <input type="text" class="search-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–µ—Å–Ω–∏" name="name" id="searchInput">
        <select class="genre-select" name="genre" id="genreSelect">
            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∂–∞–Ω—Ä</option>
            <option value="Rap">Rap</option>
            <option value="HipHop">HipHop</option>
            <option value="Rock">Rock</option>
            <option value="Blues">Blues</option>
            <option value="Disco">Disco</option>
            <option value="Techno">Techno</option>
            <option value="Electro">Electro</option>
            <option value="Other">Other</option>
        </select>
        <button type="submit" class="search-submit">–ü–æ–∏—Å–∫</button>
    </form>
</div>

<div class="music-center">

    <h2 style="display: flex; align-items: center; margin-bottom: 5px;">
        –ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ
        <div class="controls" id="audioControls" style="display: none;">
            <span class="play-pause" id="playPauseButton">‚ñ∂</span>
            <span class="restart" id="restartButton">üîÑ</span>
        </div>
    </h2>
    <ul class="music-list">
        <li th:each="audio : ${lastAddedMusic}">
            <span th:text="${audio.name}"
                  th:onclick="'playTrack(\'/audio/stream/' + ${audio.id} + '\')'"
                  style="cursor: pointer;"></span>
            <span> by <span th:if="${audio.creator.email == currentUser .email}">your</span>
                  <span th:if="${audio.creator.email != currentUser .email}" th:text="${audio.creator.username}"></span></span>
            <form th:action="@{/add-music/{id}(id=${audio.id})}" method="post" style="display: inline;">
                <button type="submit" class="add-button">–î–æ–±–∞–≤–∏—Ç—å –∫ —Å–µ–±–µ</button>
            </form>
        </li>
    </ul>
    <div th:if="${#lists.isEmpty(lastAddedMusic)}">
        <p>–ó–¥–µ—Å—å –ø–æ–∫–∞ –Ω–µ—Ç –º—É–∑—ã–∫–∏, —Å–∞–º–æ–µ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∏—Ç—å!</p>
        <button class="upload-button" onclick="location.href='/load-audio'">–î–æ–±–∞–≤–∏—Ç—å –º—É–∑—ã–∫—É</button>
    </div>
    <audio id="audioPlayer" controls style="display: none;"></audio>
</div>

<script>
    const audioPlayer = document.getElementById('audioPlayer');
    const playPauseButton = document.getElementById('playPauseButton');
    const restartButton = document.getElementById('restartButton');
    const audioControls = document.getElementById('audioControls');

    function playTrack(audioUrl) {
        audioPlayer.src = audioUrl; // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∞—É–¥–∏–æ
        audioControls.style.display = 'flex'; // –ü–æ–∫–∞–∑–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        audioPlayer.play(); // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º —Ç—Ä–µ–∫
        playPauseButton.textContent = '‚ùö‚ùö'; // –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞ –ø–∞—É–∑—É
    }

    playPauseButton.addEventListener('click', () => {
        if (audioPlayer.paused) {
            audioPlayer.play();
            playPauseButton.textContent = '‚ùö‚ùö'; // –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞ –ø–∞—É–∑—É
        } else {
            audioPlayer.pause();
            playPauseButton.textContent = '‚ñ∂'; // –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
        }
    });

    restartButton.addEventListener('click', () => {
        audioPlayer.currentTime = 0; // –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç—Ä–µ–∫
        audioPlayer.play(); // –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
        playPauseButton.textContent = '‚ùö‚ùö'; // –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞ –ø–∞—É–∑—É
    });
</script>

</body>
</html>
